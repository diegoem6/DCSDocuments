{"ast":null,"code":"import _slicedToArray from\"/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useContext,useEffect}from'react';import tagDescriptorContext from'../../context/tagdescriptor/tagDescriptorContext';import systemContext from'../../context/system/systemContext';import SunEditor from'suneditor-react';import'suneditor/dist/css/suneditor.min.css';// Import Sun Editor's CSS File\nimport alertContext from'../../context/alerts/alertContext';import{Editor}from'@tinymce/tinymce-react';//import Files from 'react-files'\nvar NewTagDescriptor=function NewTagDescriptor(){var tdContext=useContext(tagDescriptorContext);var tagname_ok=tdContext.tagname_ok,message=tdContext.message,createTagDescriptor=tdContext.createTagDescriptor,tagdescriptor=tdContext.tagdescriptor,resetMessage=tdContext.resetMessage,updateTagDescriptor=tdContext.updateTagDescriptor,validateTagname=tdContext.validateTagname;var sContext=useContext(systemContext);var systemSelected=sContext.systemSelected;var aContext=useContext(alertContext);var showAlert=aContext.showAlert;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),tagname=_useState2[0],setTagname=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];// TODO: attachments\n// const [attachments, setattachments] = useState({\n//     files:[]\n// })\nvar _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),icon=_useState6[0],seticon=_useState6[1];useEffect(function(){if(tagdescriptor!==null&&tagdescriptor.length>0){var _tagdescriptor=_slicedToArray(tagdescriptor,1),currentTagDescriptor=_tagdescriptor[0];setTagname(currentTagDescriptor.tagname);setDescription(currentTagDescriptor.description);}else{setTagname('');setDescription('');}// eslint-disable-next-line\n},[]);useEffect(function(){if(message){showAlert(message.msg,message.category);console.log(message.category);if(message.category===\"alerta-error\"){seticon('-red');}else{seticon('');}resetMessage();}// eslint-disable-next-line\n},[message]);if(!systemSelected)return null;var onChangeTagDescriptor=function onChangeTagDescriptor(e){setTagname(e.target.value);};var onBlurTagDescriptor=function onBlurTagDescriptor(e){if(!(tagdescriptor!==null&&tagdescriptor.length>0)){validateTagname(e.target.value);}seticon('');};var onChangeRichText=function onChangeRichText(value){setDescription(value);};var onSubmitTagDescriptor=function onSubmitTagDescriptor(e){e.preventDefault();//hacer validaciones y reseteo de form\nif(tagname.trim()===''||description.trim()===''){//alert(description.trim())\n//alert(tagname.trim())\nshowAlert('Debe completar tagname y descripción','alerta-error');return;}// llamo a agregar proyecto\nvar newTagDescriptor={};newTagDescriptor.tagname=tagname;newTagDescriptor.description=description;newTagDescriptor.system=systemSelected._id;//TODO: attachmentss\n//newTagDescriptor.attachments = attachments\nif(tagdescriptor!==null&&tagdescriptor.length>0){var _tagdescriptor2=_slicedToArray(tagdescriptor,1),currentTagDescriptor=_tagdescriptor2[0];newTagDescriptor._id=currentTagDescriptor._id;updateTagDescriptor(newTagDescriptor);}else{if(tagname_ok===false){if(message){showAlert(message.msg,message.category);resetMessage();}else{showAlert(\"El tag descriptor para ese tagname ya existe\",\"alerta-error\");}return;}createTagDescriptor(newTagDescriptor);}};// TODO: attachments\n// const onFilesChange = (files) => {\n//     console.log(files)\n//     console.log(files.type)\n//     setattachments({...attachments,\n//             files:files})\n// }\n// const onFilesError = (error, file) => {\n//     console.log('error code ' + error.code + ': ' + error.message)\n// }\nreturn/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Nuevo tags descriptor en el sistema: \",systemSelected.name),/*#__PURE__*/React.createElement(\"form\",{className:\"formulario-nuevo-proyecto\",onSubmit:onSubmitTagDescriptor},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"input-text\".concat(icon),placeholder:\"Tag name\",name:\"tagname\",value:tagname,onChange:onChangeTagDescriptor,readOnly:tagdescriptor!==null&&tagdescriptor.length>0,onBlur:onBlurTagDescriptor}),/*#__PURE__*/React.createElement(Editor,{initialValue:description,init:{height:500,menubar:'file edit view insert format tools table help',plugins:['advlist autolink lists link image charmap print preview anchor','searchreplace visualblocks code fullscreen','insertdatetime media table paste code help wordcount'],toolbar:'undo redo | bold italic underline strikethrough | fontselect fontsizeselect formatselect | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media template link anchor codesample | ltr rtl',toolbar_sticky:true,paste_retain_style_properties:\"all\"},onEditorChange:onChangeRichText}),tagdescriptor!==null&&tagdescriptor.length>0?/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",className:\"btn btn-primario btn-block\",value:\"Guardar Tag\"}):/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",className:\"btn btn-primario btn-block\",value:\"Agregar Tag\"})));};export default NewTagDescriptor;","map":{"version":3,"sources":["/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/src/components/tagsdescriptors/newTagDescriptor.js"],"names":["React","Fragment","useState","useContext","useEffect","tagDescriptorContext","systemContext","SunEditor","alertContext","Editor","NewTagDescriptor","tdContext","tagname_ok","message","createTagDescriptor","tagdescriptor","resetMessage","updateTagDescriptor","validateTagname","sContext","systemSelected","aContext","showAlert","tagname","setTagname","description","setDescription","icon","seticon","length","currentTagDescriptor","msg","category","console","log","onChangeTagDescriptor","e","target","value","onBlurTagDescriptor","onChangeRichText","onSubmitTagDescriptor","preventDefault","trim","newTagDescriptor","system","_id","name","height","menubar","plugins","toolbar","toolbar_sticky","paste_retain_style_properties"],"mappings":"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","sourcesContent":["import React,{Fragment, useState, useContext, useEffect} from 'react';\nimport tagDescriptorContext from '../../context/tagdescriptor/tagDescriptorContext' \nimport systemContext from '../../context/system/systemContext' \nimport SunEditor from 'suneditor-react';\nimport 'suneditor/dist/css/suneditor.min.css'; // Import Sun Editor's CSS File\nimport alertContext from '../../context/alerts/alertContext';\nimport { Editor } from '@tinymce/tinymce-react';\n//import Files from 'react-files'\n\nconst NewTagDescriptor = () => {\n    \n    const tdContext = useContext(tagDescriptorContext)\n    const {tagname_ok, message, createTagDescriptor, tagdescriptor, resetMessage, updateTagDescriptor, validateTagname} = tdContext\n\n    const sContext = useContext(systemContext)\n    const {systemSelected} = sContext\n\n    const aContext = useContext(alertContext)\n    const {showAlert} = aContext\n\n\n    const [tagname, setTagname] = useState('')\n    const [description, setDescription] = useState('')\n    // TODO: attachments\n    // const [attachments, setattachments] = useState({\n    //     files:[]\n    // })\n    \n    const [icon, seticon] = useState('')\n      \n \n    useEffect(() => {\n        if (tagdescriptor !== null && tagdescriptor.length>0){\n            const [currentTagDescriptor] = tagdescriptor\n            setTagname(currentTagDescriptor.tagname)\n            setDescription(currentTagDescriptor.description)\n            \n        }else{\n            setTagname('')\n            setDescription('')\n        }\n        // eslint-disable-next-line\n    }, [])\n\n      \n    useEffect(() => {\n        if (message){\n            showAlert(message.msg,message.category)\n            console.log(message.category)\n            if(message.category===\"alerta-error\"){\n                seticon('-red')\n            }\n            else{\n                seticon('')\n            }\n            resetMessage();\n        }\n        // eslint-disable-next-line\n    }, [message])\n\n\n\n    if (!systemSelected) return null\n\n    const onChangeTagDescriptor = (e)=>{\n        setTagname(e.target.value)\n    }\n\n    const onBlurTagDescriptor = (e)=>{\n        if (!(tagdescriptor !== null && tagdescriptor.length>0)){\n            validateTagname (e.target.value);\n        }\n        seticon('')\n    }\n\n    const onChangeRichText = (value)=>{\n        setDescription(value)\n    }\n\n    const onSubmitTagDescriptor = (e)=>{\n        e.preventDefault();\n\n        //hacer validaciones y reseteo de form\n        if (tagname.trim() === '' || description.trim()===''){\n            //alert(description.trim())\n            //alert(tagname.trim())\n            showAlert('Debe completar tagname y descripción','alerta-error')\n            return;\n        }\n\n        \n\n        // llamo a agregar proyecto\n        let newTagDescriptor = {}\n        newTagDescriptor.tagname = tagname\n        newTagDescriptor.description = description\n        newTagDescriptor.system = systemSelected._id\n        \n        \n        //TODO: attachmentss\n        //newTagDescriptor.attachments = attachments\n\n        if (tagdescriptor !== null && tagdescriptor.length>0){\n            const [currentTagDescriptor] = tagdescriptor\n            newTagDescriptor._id = currentTagDescriptor._id\n            updateTagDescriptor(newTagDescriptor)  \n        }else{\n            \n            if(tagname_ok === false){\n                \n                if (message){\n                    showAlert(message.msg,message.category)\n                    resetMessage()\n                }else{\n                    showAlert(\"El tag descriptor para ese tagname ya existe\",\"alerta-error\")\n                }\n                return;\n            }\n            createTagDescriptor(newTagDescriptor)\n\n        }\n    }\n\n    // TODO: attachments\n    // const onFilesChange = (files) => {\n    //     console.log(files)\n    //     console.log(files.type)\n    //     setattachments({...attachments,\n    //             files:files})\n    // }\n    \n    // const onFilesError = (error, file) => {\n    //     console.log('error code ' + error.code + ': ' + error.message)\n    // }\n    \n    return ( \n        <Fragment>\n                \n                <h2>Nuevo tags descriptor en el sistema: {systemSelected.name}</h2>\n                    \n                    <form   \n                        className=\"formulario-nuevo-proyecto\"\n                        onSubmit = {onSubmitTagDescriptor}\n                        >\n                        <input  \n                            type=\"text\"\n                            className={`input-text${icon}`}\n                            placeholder=\"Tag name\"\n                            name=\"tagname\"\n                            value ={tagname}\n                            onChange = {onChangeTagDescriptor}\n                            readOnly = {(tagdescriptor !== null && tagdescriptor.length>0)}\n                            onBlur = {onBlurTagDescriptor}\n                        />\n                        \n                        {/* TODO: cambio de editor */}\n                        {/* <SunEditor \n                            placeholder=\"descripción del tag\"\n                            name=\"description\"\n                            setOptions={{\n                                height: 300}}\n                            setContents ={description}\n                            onChange = {onChangeRichText}\n                        />  */}\n                        \n                        <Editor\n                            initialValue={description}\n                            init={{\n                            height: 500,\n                            menubar: 'file edit view insert format tools table help',\n                            plugins: [\n                                'advlist autolink lists link image charmap print preview anchor',\n                                'searchreplace visualblocks code fullscreen',\n                                'insertdatetime media table paste code help wordcount'\n                            ],\n                            toolbar: 'undo redo | bold italic underline strikethrough | fontselect fontsizeselect formatselect | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media template link anchor codesample | ltr rtl',\n                            toolbar_sticky: true,\n                            paste_retain_style_properties: \"all\"\n                            }\n                            }\n                            onEditorChange={onChangeRichText}\n                        />\n\n\n\n                        {/* TODO: attachments \n                        <Files\n                            className='files-dropzone'\n                            onChange={onFilesChange}\n                            onError={onFilesError}\n                            accepts={['image/png', '.jpg', '.pdf', 'audio/*']}\n                            multiple\n                            maxFiles={3}\n                            maxFileSize={10000000}\n                            minFileSize={0}\n                            clickable\n                            >\n                            Drop files here or click to upload\n                        </Files>\n                        */}\n                        {(tagdescriptor !== null && tagdescriptor.length>0) ?\n                    \n                            (<input \n                                type=\"submit\"\n                                className=\"btn btn-primario btn-block\"\n                                value = \"Guardar Tag\"\n                            /> )\n                            :\n                            (<input \n                                type=\"submit\"\n                                className=\"btn btn-primario btn-block\"\n                                value = \"Agregar Tag\"\n                            /> )\n                        }\n                          \n                    </form>\n                \n        </Fragment>\n     );\n}\n \nexport default NewTagDescriptor;"]},"metadata":{},"sourceType":"module"}