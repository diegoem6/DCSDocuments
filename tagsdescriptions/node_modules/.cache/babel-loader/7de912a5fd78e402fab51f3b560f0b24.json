{"ast":null,"code":"import _regeneratorRuntime from\"/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from'react';import authContext from'./authContext';import authReducer from'./authReducer';import axiosClient from'../../config/axios';import tokenAuth from'../../config/token';import{CREATE_USER_SUCCESS,CREATE_USER_ERROR,GET_USER,LOGIN_SUCCESS,LOGIN_ERROR,LOG_OFF,RESET_MESSAGE}from'../../types/index';var AuthState=function AuthState(props){var initialState={token:localStorage.getItem('token'),authenticated:null,user:null,message:null,loading:true};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var createUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var res,alert;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosClient.post('api/users',user);case 3:res=_context.sent;dispatch({type:CREATE_USER_SUCCESS,payload:res.data});getUser();_context.next=13;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);alert={msg:_context.t0.response.data.msg,category:'alerta-error'};dispatch({type:CREATE_USER_ERROR,payload:alert});case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function createUser(_x){return _ref.apply(this,arguments);};}();var getUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=localStorage.getItem('token');if(token){tokenAuth(token);}_context2.prev=2;_context2.next=5;return axiosClient.get('/api/auth');case 5:res=_context2.sent;dispatch({type:GET_USER,payload:res.data.user});_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);dispatch({type:LOGIN_ERROR});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function getUser(){return _ref2.apply(this,arguments);};}();var logOff=function logOff(){dispatch({type:LOG_OFF});};var loginUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(user){var res,alert;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axiosClient.post('/api/auth',user);case 3:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});getUser();_context3.next=12;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);alert={msg:_context3.t0.response.data.msg,category:'alerta-error'};dispatch({type:LOGIN_ERROR,payload:alert});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function loginUser(_x2){return _ref3.apply(this,arguments);};}();var resetMessage=function resetMessage(){dispatch({type:RESET_MESSAGE});};return/*#__PURE__*/React.createElement(authContext.Provider,{value:{token:state.token,authenticated:state.authenticated,user:state.user,message:state.message,loading:state.loading,createUser:createUser,loginUser:loginUser,getUser:getUser,logOff:logOff,resetMessage:resetMessage}},props.children);};export default AuthState;","map":{"version":3,"sources":["/Users/diegoricca/Documents/React/DCSDocuments/tagsdescriptions/src/context/auth/authState.js"],"names":["React","useReducer","authContext","authReducer","axiosClient","tokenAuth","CREATE_USER_SUCCESS","CREATE_USER_ERROR","GET_USER","LOGIN_SUCCESS","LOGIN_ERROR","LOG_OFF","RESET_MESSAGE","AuthState","props","initialState","token","localStorage","getItem","authenticated","user","message","loading","state","dispatch","createUser","post","res","type","payload","data","getUser","console","log","alert","msg","response","category","get","logOff","loginUser","resetMessage","children"],"mappings":"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","sourcesContent":["import React, {useReducer} from 'react';\nimport authContext from './authContext'\nimport authReducer from './authReducer'\nimport axiosClient from '../../config/axios'\nimport tokenAuth from '../../config/token'\n\nimport {\n    CREATE_USER_SUCCESS,\n    CREATE_USER_ERROR,\n    GET_USER, \n    LOGIN_SUCCESS,\n    LOGIN_ERROR,\n    LOG_OFF,\n    RESET_MESSAGE} from '../../types/index'\n\nconst AuthState = (props) => {\n    const initialState ={\n        token: localStorage.getItem('token'),\n        authenticated: null,\n        user: null,\n        message:null,\n        loading:true\n    }\n    const [state,dispatch] = useReducer(authReducer,initialState)\n\n    const createUser = async (user) =>{\n        try {\n            const res = await axiosClient.post('api/users', user)\n            dispatch({\n                type:CREATE_USER_SUCCESS,\n                payload:res.data\n            })\n\n            getUser()\n        } catch (error) {\n            console.log(error);\n            const alert = {\n                msg: error.response.data.msg,\n                category: 'alerta-error'\n            }\n            dispatch({\n                type:CREATE_USER_ERROR,\n                payload:alert\n            })\n            \n        }\n        \n        \n    }\n\n    const getUser = async ()=>{\n        const token = localStorage.getItem('token');\n        if (token){\n            tokenAuth(token);\n        }\n        try {\n            const res = await axiosClient.get('/api/auth')\n            dispatch({\n                type:GET_USER,\n                payload:res.data.user\n            })\n        } catch (error) {\n            dispatch({\n                type: LOGIN_ERROR\n            })\n            \n        }\n    }\n\n    const logOff = () =>{\n        dispatch({\n            type:LOG_OFF\n        })\n    }\n\n    const loginUser = async (user)=>{\n        try {\n            \n            const res = await axiosClient.post('/api/auth', user)\n            dispatch({\n                type:LOGIN_SUCCESS,\n                payload:res.data\n            })\n\n            getUser()\n            \n        } catch (error) {\n            const alert = {\n                msg: error.response.data.msg,\n                category: 'alerta-error'\n            }\n            dispatch({\n                type:LOGIN_ERROR,\n                payload:alert\n            })\n            \n        }\n    }\n    const resetMessage = () =>{\n        dispatch({\n            type:RESET_MESSAGE\n        })\n        \n    }\n\n    return (\n        <authContext.Provider \n        value={{\n            token:state.token,\n            authenticated:state.authenticated,\n            user:state.user,\n            message:state.message,\n            loading:state.loading,\n            createUser,\n            loginUser,\n            getUser,\n            logOff,\n            resetMessage\n        }}>\n            {props.children}\n        </authContext.Provider>\n    )\n\n}\nexport default AuthState;\n\n"]},"metadata":{},"sourceType":"module"}